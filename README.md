**Пояснительная записка к Telegram-боту для донорского движения НИЯУ МИФИ**

---

### **1. Общее назначение бота**
Бот разработан для автоматизации процессов взаимодействия между организаторами донорских акций и донорами НИЯУ МИФИ. Он предоставляет удобный интерфейс для регистрации, информирования и управления донорскими мероприятиями.

---

### **2. Функционал для доноров**
#### **2.1. Основные возможности:**
- **Регистрация на донорские дни (ДД):**
  - Просмотр доступных дат.
  - Выбор даты и автоматическое определение статуса (Донор/Сотрудник/Внешний донор).
- **Персональный кабинет ("Обо мне"):**
  - Просмотр своих данных (ФИО, группа/статус, история донаций).
  - Контактная информация.
- **Информационные разделы:**
  - Требования к донорам.
  - Подготовка к донации.
  - Противопоказания (абсолютные и временные).
  - Информация о донорстве костного мозга (процедура, важность).
- **Дополнительные сервисы:**
  - Онлайн-тест на возможность сдачи крови (внешняя ссылка).
  - Поиск центров донорства (внешняя ссылка).

#### **2.2. Технические особенности:**
- Авторизация по номеру телефона.
- Валидация вводимых данных.
- Интерактивное меню с кнопками для навигации.
- Уведомления о ближайших мероприятиях.

---

### **3. Функционал для организаторов (администраторов)**
#### **3.1. Управление донорами:**
- **Редактирование данных:**
  - Поиск донора по номеру телефона.
  - Изменение любых полей (ФИО, группа, статус, история донаций).
- **Массовое добавление:**
  - Загрузка списка доноров из текста (поддержка форматов CSV).
  - Обработка Excel-файлов с данными.

#### **3.2. Управление мероприятиями:**
- **Создание ДД:**
  - Добавление дат и центров крови.
  - Поддержка формата дат "DD-MM-YYYY".
- **Статистика:**
  - Просмотр регистраций и завершенных донаций.
  - Фильтрация по датам и центрам крови.
  - Экспорт в Excel.

#### **3.3. Рассылки:**
- **Таргетированные уведомления:**
  - Автоматический выбор зарегистрированных на ближайший ДД.
  - Ручной ввод текста сообщения.
  - Отчет о доставке (количество успешных отправок).

#### **3.4. Работа с документами:**
- **Импорт/экспорт данных:**
  - Загрузка статистики из Excel.
  - Выгрузка списков:
    - Все доноры.
    - Мероприятия.
    - Участники конкретного ДД.

#### **3.5. Технические особенности:**
- Проверка прав доступа (только для авторизованных админов).
- FSM (Finite State Machine) для многошаговых операций (рассылки, редактирование).
- Логирование всех действий.

---

### **4. Технологический стек**
- **Backend:** Python 3.11+, aiogram 3.x.
- **База данных:** SQLite (файл `db.db`).
- **Дополнительно:**
  - `pandas` для работы с Excel.
  - `openpyxl` для форматирования отчетов.
  - `aiosqlite` для асинхронного доступа к БД.

---

### **5. Безопасность**
- Валидация ввода (номера телефонов, даты).
- Ограничение доступа к админ-панели (проверка `is_admin`).
- Отсутствие хранения критичных данных (паролей) в открытом виде.
